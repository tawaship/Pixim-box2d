/*!
 * pixi-box2d - v1.0.1
 * 
 * @require pixi.js v^5.3.3
 * @require Box2d.js
 * @author tawaship (makazu.mori@gmail.com)
 * @license MIT
 */
this.Pixim=this.Pixim||{},function(t,e,o,i){"use strict";var a=o.Common.Math.b2Vec2,r=o.Dynamics.b2DebugDraw,n=o.Dynamics.b2World,s=(o.Dynamics.Contacts.b2Contact,o.Dynamics.b2ContactListener),d=o.Dynamics.b2BodyDef,c=o.Dynamics.b2FixtureDef,y=o.Dynamics.b2Body,b=o.Collision.Shapes.b2CircleShape,l=o.Collision.Shapes.b2PolygonShape,p=(o.Collision.Shapes.b2EdgeShape,1/30);function u(t){var e=t.GetFixtureA().GetUserData(),o=t.GetFixtureB().GetUserData();e&&e.emit&&e.emit("BeginContact",o),o&&o.emit&&o.emit("BeginContact",e)}function h(t){var e=t.GetFixtureA().GetUserData(),o=t.GetFixtureB().GetUserData();e&&e.emit&&e.emit("EndContact",o),o&&o.emit&&o.emit("EndContact",e)}function f(t){var e=t.GetFixtureA().GetUserData(),o=t.GetFixtureB().GetUserData();e&&e.emit&&e.emit("PreSolve",o),o&&o.emit&&o.emit("PreSolve",e)}function x(t){var e=t.GetFixtureA().GetUserData(),o=t.GetFixtureB().GetUserData();e&&e.emit&&e.emit("PostSolve",o),o&&o.emit&&o.emit("PostSolve",e)}var D=function(t){function o(o){var i=this;t.call(this);var r="number"==typeof o.gravityX?o.gravityX:0,d="number"==typeof o.gravityY?o.gravityY:9.8,c=!!o.allowSleep,y=new n(new a(r,d),c);this._box2dData={world:y,listener:new s,enabled:!0,speed:1,targets:{},deletes:{},task:new e.Task([],this)},this._box2dData.task.add((function(t){i._handleTick(t.delta)})),this._box2dData.task.first();var b=this._box2dData.listener;o.listenBeginContact&&(b.BeginContact=u),o.listenEndContact&&(b.EndContact=h),o.listenPreSolve&&(b.PreSolve=f),o.listenPostSolve&&(b.PostSolve=x),y.SetContactListener(b),this.box2dEnabled=!0}t&&(o.__proto__=t),o.prototype=Object.create(t&&t.prototype),o.prototype.constructor=o;var i={speed:{configurable:!0},box2dEnabled:{configurable:!0},world:{configurable:!0}};return o.prototype.addDebugDraw=function(t){var e=document.createElement("canvas"),o=e.getContext("2d");if(!o)return e;e.width=t.width,e.height=t.height,e.style.width=t.style.width,e.style.height=t.style.height,e.style.top=t.style.top||"0",e.style.left=t.style.left||"0",e.style.position="absolute",e.style.pointerEvents="none",e.style.zIndex="100";var i=new r;return i.SetSprite(o),i.SetDrawScale(30),i.SetFillAlpha(.5),i.SetLineThickness(1),i.SetFlags(r.e_shapeBit|r.e_jointBit),this.world.SetDebugDraw(i),e},o.prototype.updateTask=function(e){t.prototype.updateTask.call(this,e);var o=this._box2dData.task;this.taskEnabled&&o.done(e)},o.prototype._handleTick=function(t){if(this._box2dData.enabled){var e=this._box2dData.world;e.Step(t*this._box2dData.speed/30,10,10),e.ClearForces(),e.DrawDebugData();var o=this._box2dData.targets;for(var i in this._box2dData.deletes){var a=this._box2dData.deletes[i];delete o[i],a.body&&(e.DestroyBody(a.body),a.body=null)}for(var r in this._box2dData.deletes=[],o){var n=o[r];if(n.body){var s=n.body.GetPosition();n.x=30*s.x,n.y=30*s.y,n.rotation=n.body.GetAngle()}}}},i.speed.get=function(){return this._box2dData.speed},i.speed.set=function(t){this._box2dData.speed=t},i.box2dEnabled.get=function(){return this._box2dData.enabled},i.box2dEnabled.set=function(t){this._box2dData.enabled=t},i.world.get=function(){return this._box2dData.world},o.prototype.addBox2d=function(t){if(!t.body){for(var e=this._box2dData.world.CreateBody(t.getBodyDef()),o=t.getFixtureDefs(),i=0;i<o.length;i++)e.CreateFixture(o[i]);t.body=e,e.SetPosition(new a(t.x*p,t.y*p)),e.SetAngle(t.rotation)}return t.reflect(),this.addChild(t),this._box2dData.targets[t.box2dID]=t,delete this._box2dData.deletes[t.box2dID],t},o.prototype.removeBox2d=function(t){return this.removeChild(t),this._box2dData.deletes[t.box2dID]=t,t},Object.defineProperties(o.prototype,i),o}(e.Container);function _(t){void 0===t&&(t=!1);var e=new d;return t?e.type=y.b2_dynamicBody:y.b2_staticBody,e}var v=_(!0),m=_(!1);var g=function(t){function e(o){void 0===o&&(o={}),t.call(this);var i=function(t,e){void 0===t&&(t={});var o=new c;return o.density="number"==typeof t.density?t.density:o.density,o.friction="number"==typeof t.friction?t.friction:o.friction,o.restitution="number"==typeof t.restitution?t.restitution:o.restitution,o.filter.categoryBits="number"==typeof t.categoryBits?t.categoryBits:o.filter.categoryBits,o.filter.maskBits="number"==typeof t.maskBits?t.maskBits:o.filter.maskBits,o.isSensor=!!t.isSensor,o.userData=e,o}(o,this);this._box2dData={id:e._id++,body:null,bodyDef:o.isStatic?m:v,fixtureDefs:[i],maskBits:i.filter.maskBits}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var o={box2dID:{configurable:!0},body:{configurable:!0}};return e.prototype.BeginContact=function(t){},e.prototype.EndContact=function(t){},e.prototype.PreSolve=function(t){},e.prototype.PostSolve=function(t){},e.prototype.getBodyDef=function(){return this._box2dData.bodyDef},e.prototype.getFixtureDefs=function(){return this._box2dData.fixtureDefs},o.box2dID.get=function(){return this._box2dData.id},o.body.get=function(){return this._box2dData.body},o.body.set=function(t){this._box2dData.body=t},e.prototype.setX=function(t){this.x=t;var e=this._box2dData.body;if(e){var o=e.GetPosition();o.x=t*p,e.SetPosition(o)}},e.prototype.setY=function(t){this.y=t;var e=this._box2dData.body;if(e){var o=e.GetPosition();o.y=t*p,e.SetPosition(o)}},e.prototype.setRotation=function(t){this.rotation=t;var e=this._box2dData.body;e&&e.SetAngle(t)},e.prototype.reflect=function(){this.setX(this.x),this.setY(this.y),this.setRotation(this.rotation),this.addMask(this._box2dData.maskBits)},e.prototype.addMask=function(t){if(this._box2dData.maskBits|=t,this._box2dData.body)for(var e=this._box2dData.body.GetFixtureList();e;){var o=e.GetFilterData();o.maskBits=this._box2dData.maskBits,e.SetFilterData(o),e=e.GetNext()}},e.prototype.addAllMask=function(){if(this._box2dData.maskBits=65535,this._box2dData.body)for(var t=this._box2dData.body.GetFixtureList();t;){var e=t.GetFilterData();e.maskBits=65535,t.SetFilterData(e),t=t.GetNext()}},e.prototype.removeMask=function(t){if(this._box2dData.maskBits^=this._box2dData.maskBits&t,this._box2dData.body)for(var e=this._box2dData.body.GetFixtureList();e;){var o=e.GetFilterData();o.maskBits=this._box2dData.maskBits,e.SetFilterData(o),e=e.GetNext()}},e.prototype.removeAllMask=function(){if(this._box2dData.maskBits=0,this._box2dData.body)for(var t=this._box2dData.body.GetFixtureList();t;){var e=t.GetFilterData();e.maskBits=0,t.SetFilterData(e),t=t.GetNext()}},e.prototype.toDynamic=function(){this._box2dData.body&&this._box2dData.body.SetType(y.b2_dynamicBody)},e.prototype.toStatic=function(){this._box2dData.body&&this._box2dData.body.SetType(y.b2_staticBody)},Object.defineProperties(e.prototype,o),e}(i.Container);g._id=0,delete g.prototype.BeginContact,delete g.prototype.EndContact,delete g.prototype.PreSolve,delete g.prototype.PostSolve;var B=function(t){function e(e,o){void 0===o&&(o={}),t.call(this,o),this.getFixtureDefs()[0].shape=new b(e*p)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.from=function(t,o){void 0===o&&(o={});var a=new e(Math.max(t.width/2,t.height/2),o),r=a.addChild(new i.Container);r.addChild(t);var n=a.getLocalBounds();return r.x=-n.x-t.width/2,r.y=-n.y-t.height/2,a},e}(g),S=function(t){function e(e,o,i){void 0===i&&(i={}),t.call(this,i),e*=p,o*=p;var r=this.getFixtureDefs()[0],n=new l;n.SetAsArray([new a(0,0),new a(e,0),new a(e,o),new a(0,o)]),r.shape=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.from=function(t,o){void 0===o&&(o={});var a=new e(t.width,t.height,o),r=a.addChild(new i.Container);r.addChild(t);var n=a.getLocalBounds();return r.x=-n.x,r.y=-n.y,a},e}(g),w=function(t){function e(e,o){void 0===o&&(o={}),t.call(this,o);var i=this.getFixtureDefs()[0],a=new l;a.SetAsArray(e),i.shape=a}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(g),C=function(t){function e(e,o){void 0===o&&(o={}),t.call(this,o);var i=this.getFixtureDefs()[0],r=new l;r.SetAsEdge(new a(0,0),new a(e.x*p,e.y*p)),i.shape=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(g);Object.keys(o).forEach((function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})})),t.Box2dObject=g,t.Circle=B,t.Edge=C,t.Polygon=w,t.Rectangle=S,t.WorldContainer=D}(this.Pixim.box2d=this.Pixim.box2d||{},Pixim,Box2D,PIXI);//# sourceMappingURL=Pixim-box2d.min.js.map
